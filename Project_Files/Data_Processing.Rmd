**Setup**
```{r setup}
# Set working directory
library(here)
here()

# Load packages
library(tidyverse)
library("dataRetrieval")
library(dplyr)
library(lubridate)
```

**Load datasets**
*Discharge*
```{r}
# Madison County gauges
### September 2023 - March 2024 (before)
FBR_HotSprings.discharge.before <- readNWISuv(siteNumbers = "03454500",
                                       parameterCd = "00060",
                                       startDate = "2023-09-27", 
                                       endDate = "2024-03-27", 
                                       tz = "America/New_York")
write.csv(FBR_HotSprings.discharge.before, 
          here("Data", "Raw", "FBR_HotSprings.discharge.before.csv"), row.names = FALSE)

FBR_Marshall.discharge.before <-readNWISuv(siteNumbers = "03453500",
                                       parameterCd = "00060",
                                       startDate = "2023-09-27", 
                                       endDate = "2024-03-27", 
                                       tz = "America/New_York")
write.csv(FBR_Marshall.discharge.before,
          here("Data", "Raw", "FBR_Marshall.discharge.before.csv"), row.names = FALSE)

### September 2024 - March 2025 (after)
FBR_HotSprings.discharge.after <- readNWISuv(siteNumbers = "03454500",
                                       parameterCd = "00060",
                                       startDate = "2024-09-27", 
                                       endDate = "2025-03-27", 
                                       tz = "America/New_York")
write.csv(FBR_HotSprings.discharge.after, 
          here("Data", "Raw", "FBR_HotSprings.discharge.after.csv"), row.names = FALSE)

FBR_Marshall.discharge.after <-readNWISuv(siteNumbers = "03453500",
                                       parameterCd = "00060",
                                       startDate = "2024-09-27", 
                                       endDate = "2025-03-27", 
                                       tz = "America/New_York")
write.csv(FBR_Marshall.discharge.after,
          here("Data", "Raw", "FBR_Marshall.discharge.after.csv"), row.names = FALSE)

## Buncombe County
### September 2023 - March 2024 (before)
FBR_Asheville.discharge.before <- readNWISuv(siteNumbers = "03451500",
                                       parameterCd = "00060",
                                       startDate = "2023-09-27", 
                                       endDate = "2024-03-27", 
                                       tz = "America/New_York")
write.csv(FBR_Asheville.discharge.before,
          here("Data", "Raw", "FBR_Asheville.discharge.before.csv"), row.names = FALSE)

BeetreeCreek_Swannanoa.discharge.before <- readNWISuv(siteNumbers = "03450000",
                                       parameterCd = "00060",
                                       startDate = "2023-09-27", 
                                       endDate = "2024-03-27", 
                                       tz = "America/New_York")
write.csv(BeetreeCreek_Swannanoa.discharge.before,
          here("Data", "Raw", "BeetreeCreek_Swannanoa.discharge.before.csv"), row.names = FALSE)

NFSwannanoa_Walkertown.discharge.before <- readNWISuv(siteNumbers = "0344894205",
                                       parameterCd = "00060",
                                       startDate = "2023-09-27", 
                                       endDate = "2024-03-27", 
                                       tz = "America/New_York")
write.csv(NFSwannanoa_Walkertown.discharge.before,
          here("Data", "Raw", "NFSwannanoa_Walkertown.discharge.before.csv"), row.names = FALSE)

Swannanoa_Biltmore.discharge.before <- readNWISuv(siteNumbers = "03451000",
                                       parameterCd = "00060",
                                       startDate = "2023-09-27", 
                                       endDate = "2024-03-27", 
                                       tz = "America/New_York")
write.csv(Swannanoa_Biltmore.discharge.before,
          here("Data", "Raw", "Swannanoa_Biltmore.discharge.before.csv"), row.names = FALSE)

### September 2024 - March 2025 (after)
FBR_Asheville.discharge.after <- readNWISuv(siteNumbers = "03451500",
                                       parameterCd = "00060",
                                       startDate = "2024-09-27", 
                                       endDate = "2025-03-27", 
                                       tz = "America/New_York")
write.csv(FBR_Asheville.discharge.after,
          here("Data", "Raw", "FBR_Asheville.discharge.after.csv"), row.names = FALSE)

BeetreeCreek_Swannanoa.discharge.after <- readNWISuv(siteNumbers = "03450000",
                                       parameterCd = "00060",
                                       startDate = "2024-09-27", 
                                       endDate = "2025-03-27", 
                                       tz = "America/New_York")
write.csv(BeetreeCreek_Swannanoa.discharge.after,
          here("Data", "Raw", "BeetreeCreek_Swannanoa.discharge.after.csv"), row.names = FALSE)

NFSwannanoa_Walkertown.discharge.after <- readNWISuv(siteNumbers = "0344894205",
                                       parameterCd = "00060",
                                       startDate = "2024-09-27", 
                                       endDate = "2025-03-27", 
                                       tz = "America/New_York")
write.csv(NFSwannanoa_Walkertown.discharge.after,
          here("Data", "Raw", "NFSwannanoa_Walkertown.discharge.after.csv"), row.names = FALSE)

Swannanoa_Biltmore.discharge.after <- readNWISuv(siteNumbers = "03451000",
                                       parameterCd = "00060",
                                       startDate = "2024-09-27", 
                                       endDate = "2025-03-27", 
                                       tz = "America/New_York")
write.csv(Swannanoa_Biltmore.discharge.after,
          here("Data", "Raw", "Swannanoa_Biltmore.discharge.after.csv"), row.names = FALSE)


## Henderson County
### September 2023 - March 2024 (before)
FBR_Fletcher.discharge.before <- readNWISuv(siteNumbers = "03447687",
                                       parameterCd = "00060",
                                       startDate = "2023-09-27", 
                                       endDate = "2024-03-27", 
                                       tz = "America/New_York")
write.csv(FBR_Fletcher.discharge.before,
          here("Data", "Raw", "FBR_Fletcher.discharge.before.csv"), row.names = FALSE)

FBR_Blantyre.discharge.before <- readNWISuv(siteNumbers = "03443000",
                                       parameterCd = "00060",
                                       startDate = "2023-09-27", 
                                       endDate = "2024-03-27", 
                                       tz = "America/New_York")
write.csv(FBR_Blantyre.discharge.before,
          here("Data", "Raw", "FBR_Blantyre.discharge.before.csv"), row.names = FALSE)

FBR_Rosman.discharge.before <-readNWISuv(siteNumbers = "03439000",
                                       parameterCd = "00060",
                                       startDate = "2023-09-27", 
                                       endDate = "2024-03-27", 
                                       tz = "America/New_York")
write.csv(FBR_Rosman.discharge.before,
          here("Data", "Raw", "FBR_Rosman.discharge.before.csv"), row.names = FALSE)

### September 2024 - March 2025 (after)
FBR_Fletcher.discharge.after <- readNWISuv(siteNumbers = "03447687",
                                       parameterCd = "00060",
                                       startDate = "2024-09-27", 
                                       endDate = "2025-03-27", 
                                       tz = "America/New_York")
write.csv(FBR_Fletcher.discharge.after,
          here("Data", "Raw", "FBR_Fletcher.discharge.after.csv"), row.names = FALSE)

FBR_Blantyre.discharge.after <- readNWISuv(siteNumbers = "03443000",
                                       parameterCd = "00060",
                                       startDate = "2024-09-27", 
                                       endDate = "2025-03-27", 
                                       tz = "America/New_York")
write.csv(FBR_Blantyre.discharge.after,
          here("Data", "Raw", "FBR_Blantyre.discharge.after.csv"), row.names = FALSE)

FBR_Rosman.discharge.after <-readNWISuv(siteNumbers = "03439000",
                                       parameterCd = "00060",
                                       startDate = "2024-09-27", 
                                       endDate = "2025-03-27", 
                                       tz = "America/New_York")
write.csv(FBR_Rosman.discharge.after,
          here("Data", "Raw", "FBR_Rosman.discharge.after.csv"), row.names = FALSE)

```


**Cleanup**
*Discharge*
Rename discharge column and delete unneccesary columnn
```{r}
#Rename column names and delete data qualifier column
## X_00060_00000 to discharge_cfs
FBR_HotSprings.discharge.before <- FBR_HotSprings.discharge.before %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(FBR_HotSprings.discharge.before, 
          here("Data", "Processed", "FBR_HotSprings.discharge.before.csv"), row.names = FALSE)

FBR_HotSprings.discharge.after <- FBR_HotSprings.discharge.after %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(FBR_HotSprings.discharge.after, 
          here("Data", "Processed", "FBR_HotSprings.discharge.after.csv"), row.names = FALSE)

FBR_Marshall.discharge.before <- FBR_Marshall.discharge.before %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(FBR_Marshall.discharge.before, 
          here("Data", "Processed", "FBR_Marshall.discharge.before.csv"), row.names = FALSE)
  
FBR_Marshall.discharge.after <- FBR_Marshall.discharge.after %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(FBR_Marshall.discharge.after, 
          here("Data", "Processed", "FBR_Marshall.discharge.after.csv"), row.names = FALSE)

FBR_Asheville.discharge.before <- FBR_Asheville.discharge.before %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(FBR_Asheville.discharge.before, 
          here("Data", "Processed", "FBR_Asheville.discharge.before.csv"), row.names = FALSE)

FBR_Asheville.discharge.after <- FBR_Asheville.discharge.after %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(FBR_Asheville.discharge.after, 
          here("Data", "Processed", "FBR_Asheville.discharge.after.csv"), row.names = FALSE)

BeetreeCreek_Swannanoa.discharge.before <- BeetreeCreek_Swannanoa.discharge.before %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(BeetreeCreek_Swannanoa.discharge.before, 
          here("Data", "Processed", "BeetreeCreek_Swannanoa.discharge.before.csv"), row.names = FALSE)

BeetreeCreek_Swannanoa.discharge.after <- BeetreeCreek_Swannanoa.discharge.after %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(BeetreeCreek_Swannanoa.discharge.after, 
          here("Data", "Processed", "BeetreeCreek_Swannanoa.discharge.after.csv"), row.names = FALSE)

NFSwannanoa_Walkertown.discharge.before <- NFSwannanoa_Walkertown.discharge.before %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(NFSwannanoa_Walkertown.discharge.before, 
          here("Data", "Processed", "NFSwannanoa_Walkertown.discharge.before.csv"), row.names = FALSE)

NFSwannanoa_Walkertown.discharge.after <- NFSwannanoa_Walkertown.discharge.after %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(NFSwannanoa_Walkertown.discharge.after, 
          here("Data", "Processed", "NFSwannanoa_Walkertown.discharge.after.csv"), row.names = FALSE)

Swannanoa_Biltmore.discharge.before <- Swannanoa_Biltmore.discharge.before %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(Swannanoa_Biltmore.discharge.before, 
          here("Data", "Processed", "Swannanoa_Biltmore.discharge.before.csv"), row.names = FALSE)

Swannanoa_Biltmore.discharge.after <- Swannanoa_Biltmore.discharge.after %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(Swannanoa_Biltmore.discharge.after, 
          here("Data", "Processed", "Swannanoa_Biltmore.discharge.after.csv"), row.names = FALSE)

FBR_Fletcher.discharge.before <- FBR_Fletcher.discharge.before %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(FBR_Fletcher.discharge.before, 
          here("Data", "Processed", "FBR_Fletcher.discharge.before.csv"), row.names = FALSE)

FBR_Fletcher.discharge.after <- FBR_Fletcher.discharge.after %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(FBR_Fletcher.discharge.after, 
          here("Data", "Processed", "FBR_Fletcher.discharge.after.csv"), row.names = FALSE)

FBR_Blantyre.discharge.before <- FBR_Blantyre.discharge.before %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(FBR_Blantyre.discharge.before, 
          here("Data", "Processed", "FBR_Blantyre.discharge.before.csv"), row.names = FALSE)

FBR_Blantyre.discharge.after <- FBR_Blantyre.discharge.after %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(FBR_Blantyre.discharge.after, 
          here("Data", "Processed", "FBR_Blantyre.discharge.after.csv"), row.names = FALSE)

FBR_Rosman.discharge.before <- FBR_Rosman.discharge.before %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(FBR_Rosman.discharge.before, 
          here("Data", "Processed", "FBR_Rosman.discharge.before.csv"), row.names = FALSE)

FBR_Rosman.discharge.after <- FBR_Rosman.discharge.after %>%
  rename(discharge_cfs = X_00060_00000) %>%
  select(-X_00060_00000_cd)
write.csv(FBR_Rosman.discharge.after, 
          here("Data", "Processed", "FBR_Rosman.discharge.after.csv"), row.names = FALSE)
```

Create mean daily discharge datasets for before and after time periods
```{r}
# Create daily discharge dataset using mean
FBR_HotSprings.Dailydischarge.before <- FBR_HotSprings.discharge.before %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2023-2024",
         name = "FBR Hot Springs",
         ID_number = "03454500") # creating new columns
write.csv(FBR_HotSprings.Dailydischarge.before, 
          here("Data", "Processed", "FBR_HotSprings.Dailydischarge.before.csv"), row.names = FALSE)

FBR_HotSprings.Dailydischarge.after <- FBR_HotSprings.discharge.after %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2024-2025",
         name = "FBR Hot Springs",
         ID_number = "03454500") # creating new columns
write.csv(FBR_HotSprings.Dailydischarge.after, 
          here("Data", "Processed", "FBR_HotSprings.Dailydischarge.after.csv"), row.names = FALSE)

FBR_Marshall.Dailydischarge.before <- FBR_Marshall.discharge.before %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2023-2024",
         name = "FBR Marshall",
         ID_number = "03453500") # creating new columns
write.csv(FBR_Marshall.Dailydischarge.before, 
          here("Data", "Processed", "FBR_Marshall.Dailydischarge.before.csv"), row.names = FALSE)

FBR_Marshall.Dailydischarge.after <- FBR_Marshall.discharge.after %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2024-2025",
         name = "FBR Marshall",
         ID_number = "03453500") # creating new columns)
write.csv(FBR_Marshall.Dailydischarge.after, 
          here("Data", "Processed", "FBR_Marshall.Dailydischarge.after.csv"), row.names = FALSE)

FBR_Asheville.Dailydischarge.before <- FBR_Asheville.discharge.before %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2023-2024",
         name = "FBR_Asheville",
         ID_number = "03451500") # creating new columns
write.csv(FBR_Asheville.Dailydischarge.before, 
          here("Data", "Processed", "FBR_Asheville.Dailydischarge.before.csv"), row.names = FALSE)
  
FBR_Asheville.Dailydischarge.after <- FBR_Asheville.discharge.after %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2024-2025",
         name = "FBR_Asheville",
         ID_number = "03451500") # creating new columns)
write.csv(FBR_Asheville.Dailydischarge.after, 
          here("Data", "Processed", "FBR_Asheville.Dailydischarge.after.csv"), row.names = FALSE)

BeetreeCreek_Swannanoa.Dailydischarge.before <- BeetreeCreek_Swannanoa.discharge.before %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2023-2024",
         name = "Bee_Tree_Creek_Swannanoa",
         ID_number = "03450000") # creating time period column
write.csv(BeetreeCreek_Swannanoa.Dailydischarge.before, 
          here("Data", "Processed", "BeetreeCreek_Swannanoa.Dailydischarge.before.csv"), row.names = FALSE)

 BeetreeCreek_Swannanoa.Dailydischarge.after<- BeetreeCreek_Swannanoa.discharge.after %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2024-2025",
         name = "Bee_Tree_Creek_Swannanoa",
         ID_number = "03450000") # creating time period column 
 write.csv(BeetreeCreek_Swannanoa.Dailydischarge.after, 
          here("Data", "Processed", "BeetreeCreek_Swannanoa.Dailydischarge.after.csv"), row.names = FALSE)
 
NFSwannanoa_Walkertown.Dailydischarge.before  <- NFSwannanoa_Walkertown.discharge.before %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2023-2024",
         name = "NF_Swannanoa_Walkertown",
         ID_number = "0344894205 ") # creating new columns
write.csv(NFSwannanoa_Walkertown.Dailydischarge.before, 
          here("Data", "Processed", "NFSwannanoa_Walkertown.Dailydischarge.before.csv"), row.names = FALSE)

NFSwannanoa_Walkertown.Dailydischarge.after <- NFSwannanoa_Walkertown.discharge.after %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2024-2025",
         name = "NF_Swannanoa_Walkertown",
         ID_number = "0344894205 ") # creating new columns
write.csv(NFSwannanoa_Walkertown.Dailydischarge.after, 
          here("Data", "Processed", "NFSwannanoa_Walkertown.Dailydischarge.after.csv"), row.names = FALSE)

Swannanoa_Biltmore.Dailydischarge.before <- Swannanoa_Biltmore.discharge.before %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2023-2024",
         name = "Swannanoa_Biltmore",
         ID_number = "03451000") # creating new columns
write.csv(Swannanoa_Biltmore.Dailydischarge.before, 
          here("Data", "Processed", "Swannanoa_Biltmore.Dailydischarge.before.csv"), row.names = FALSE)

Swannanoa_Biltmore.Dailydischarge.after <- Swannanoa_Biltmore.discharge.after %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2024-2025",
         name = "Swannanoa_Biltmore",
         ID_number = "03451000") # creating new columns
write.csv(Swannanoa_Biltmore.Dailydischarge.after, 
          here("Data", "Processed", "Swannanoa_Biltmore.Dailydischarge.after.csv"), row.names = FALSE)

FBR_Fletcher.Dailydischarge.before <- FBR_Fletcher.discharge.before %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2023-2024",
         name = "FBR_Fletcher",
         ID_number = "03447687") # creating new columns
write.csv(FBR_Fletcher.Dailydischarge.before, 
          here("Data", "Processed", "FBR_Fletcher.Dailydischarge.before.csv"), row.names = FALSE)

FBR_Fletcher.Dailydischarge.after <- FBR_Fletcher.discharge.after %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2024-2025",
         name = "FBR_Fletcher",
         ID_number = "03447687") # creating new columns
write.csv(FBR_Fletcher.Dailydischarge.after, 
          here("Data", "Processed", "FBR_Fletcher.Dailydischarge.after.csv"), row.names = FALSE)
         
FBR_Blantyre.Dailydischarge.before <- FBR_Blantyre.discharge.before %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2023-2024",
         name = "FBR_Blantyre",
         ID_number = "03443000") # creating new columns
write.csv(FBR_Blantyre.Dailydischarge.before, 
          here("Data", "Processed", "FBR_Blantyre.Dailydischarge.before.csv"), row.names = FALSE)

FBR_Blantyre.Dailydischarge.after <- FBR_Blantyre.discharge.after %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2024-2025",
         name = "FBR_Blantyre",
         ID_number = "03443000") # creating new columns
write.csv(FBR_Blantyre.Dailydischarge.after, 
          here("Data", "Processed", "FBR_Blantyre.Dailydischarge.after.csv"), row.names = FALSE)

FBR_Rosman.Dailydischarge.before <- FBR_Rosman.discharge.before %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2023-2024",
         name = "FBR_Rosman",
         ID_number = "03439000") # creating new columns
write.csv(FBR_Rosman.Dailydischarge.before, 
          here("Data", "Processed", "FBR_Rosman.Dailydischarge.before.csv"), row.names = FALSE)

FBR_Rosman.Dailydischarge.after <- FBR_Rosman.discharge.after %>%
  mutate(date = as_date(dateTime)) %>% #Extracting date
  group_by(date) %>%
  summarise(mean_daily_discharge_cfs = mean(discharge_cfs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(time_period = "2024-2025",
         name = "FBR_Rosman",
         ID_number = "03439000") # creating new columns
write.csv(FBR_Rosman.Dailydischarge.after, 
          here("Data", "Processed", "FBR_Blantyre.Dailydischarge.before.csv"), row.names = FALSE)
```

Create monthly discharge datasets for before and after time periods
```{r}
# Create monthly discharge using mean
FBR_HotSprings.Monthlydischarge.before <- FBR_HotSprings.Dailydischarge.before %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(FBR_HotSprings.Monthlydischarge.before, 
          here("Data", "Processed", "FBR_HotSprings.Monthlydischarge.before.csv"), row.names = FALSE)

FBR_HotSprings.Monthlydischarge.after <- FBR_HotSprings.Dailydischarge.after %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(FBR_HotSprings.Monthlydischarge.after, 
          here("Data", "Processed", "FBR_HotSprings.Monthlydischarge.after.csv"), row.names = FALSE)


FBR_Marshall.Monthlydischarge.before <- FBR_Marshall.Dailydischarge.before %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(FBR_Marshall.Monthlydischarge.before, 
          here("Data", "Processed", "FBR_Marshall.Monthlydischarge.before.csv"), row.names = FALSE)

FBR_Marshall.Monthlydischarge.after <- FBR_Marshall.Dailydischarge.after %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(FBR_Marshall.Monthlydischarge.after, 
          here("Data", "Processed", "FBR_Marshall.Monthlydischarge.after.csv"), row.names = FALSE)

FBR_Asheville.Monthlydischarge.before <- FBR_Asheville.Dailydischarge.before %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(FBR_Asheville.Monthlydischarge.before, 
          here("Data", "Processed", "FBR_Asheville.Monthlydischarge.before.csv"), row.names = FALSE)

FBR_Asheville.Monthlydischarge.after <- FBR_Asheville.Dailydischarge.after %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(FBR_Asheville.Monthlydischarge.after, 
          here("Data", "Processed", "FBR_Asheville.Monthlydischarge.after.csv"), row.names = FALSE)

BeetreeCreek_Swannanoa.Monthlydischarge.before <- BeetreeCreek_Swannanoa.Dailydischarge.before %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(BeetreeCreek_Swannanoa.Monthlydischarge.before, 
          here("Data", "Processed", "BeetreeCreek_Swannanoa.Monthlydischarge.before.csv"), row.names = FALSE)

BeetreeCreek_Swannanoa.Monthlydischarge.after <- BeetreeCreek_Swannanoa.Dailydischarge.after %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(BeetreeCreek_Swannanoa.Monthlydischarge.after, 
          here("Data", "Processed", "BeetreeCreek_Swannanoa.Monthlydischarge.after.csv"), row.names = FALSE)

NFSwannanoa_Walkertown.Monthlydischarge.before <- NFSwannanoa_Walkertown.Dailydischarge.before %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(NFSwannanoa_Walkertown.Monthlydischarge.before, 
          here("Data", "Processed", "NF_Swannanoa_Walkertown.Monthlydischarge.before.csv"), row.names = FALSE)

NFSwannanoa_Walkertown.Monthlydischarge.after <- NFSwannanoa_Walkertown.Dailydischarge.after %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(NFSwannanoa_Walkertown.Monthlydischarge.after, 
          here("Data", "Processed", "NF_Swannanoa_Walkertown.Monthlydischarge.after.csv"), row.names = FALSE)

Swannanoa_Biltmore.Monthlydischarge.before <- Swannanoa_Biltmore.Dailydischarge.before %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(Swannanoa_Biltmore.Monthlydischarge.before, 
          here("Data", "Processed", "Swannanoa_Biltmore.Monthlydischarge.before.csv"), row.names = FALSE)

Swannanoa_Biltmore.Monthlydischarge.after <- Swannanoa_Biltmore.Dailydischarge.after %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(Swannanoa_Biltmore.Monthlydischarge.after, 
          here("Data", "Processed", "Swannanoa_Biltmore.Monthlydischarge.after.csv"), row.names = FALSE)
  
FBR_Fletcher.Monthlydischarge.before <- FBR_Fletcher.Dailydischarge.before %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(FBR_Fletcher.Monthlydischarge.before, 
          here("Data", "Processed", "FBR_Fletcher.Monthlydischarge.before.csv"), row.names = FALSE)

FBR_Fletcher.Monthlydischarge.after <- FBR_Fletcher.Dailydischarge.after %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(FBR_Fletcher.Monthlydischarge.after, 
          here("Data", "Processed", "FBR_Fletcher.Monthlydischarge.after.csv"), row.names = FALSE)

FBR_Blantyre.Monthlydischarge.before <- FBR_Blantyre.Dailydischarge.before %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(FBR_Blantyre.Monthlydischarge.before, 
          here("Data", "Processed", "FBR_Blantyre.Monthlydischarge.before.csv"), row.names = FALSE)

FBR_Blantyre.Monthlydischarge.after <- FBR_Blantyre.Dailydischarge.after %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(FBR_Blantyre.Monthlydischarge.after, 
          here("Data", "Processed", "FBR_Blantyre.Monthlydischarge.after.csv"), row.names = FALSE)

FBR_Rosman.Monthlydischarge.before <- FBR_Rosman.Dailydischarge.before %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(FBR_Rosman.Monthlydischarge.before, 
          here("Data", "Processed", "FBR_Rosman.Monthlydischarge.before.csv"), row.names = FALSE)

FBR_Rosman.Monthlydischarge.after <- FBR_Rosman.Dailydischarge.after %>%
  mutate(year = year(date),
         month = month(date)) %>%
  group_by(year,month,time_period,name,ID_number) %>%
  summarise(mean_monthly_discharge_cfs = mean(mean_daily_discharge_cfs, na.rm = TRUE)) %>%
  ungroup()
write.csv(FBR_Rosman.Monthlydischarge.after, 
          here("Data", "Processed", "FBR_Rosman.Monthlydischarge.after.csv"), row.names = FALSE)

```

Create before and after combined datasets | Daily Discharge
```{r}
FBR_Hotsprings.Dailydischarge.combined <- 
  bind_rows(FBR_HotSprings.Dailydischarge.before, 
            FBR_HotSprings.Dailydischarge.after)
write.csv(FBR_Hotsprings.Dailydischarge.combined, 
          here("Data", "Processed", "FBR_Hotsprings.Dailydischarge.combined.csv"), row.names = FALSE)

FBR_Marshall.Dailydischarge.combined <- 
  bind_rows(FBR_Marshall.Dailydischarge.before,
            FBR_Marshall.Dailydischarge.after)
write.csv(FBR_Marshall.Dailydischarge.combined, 
          here("Data", "Processed", "FBR_Marshall.Dailydischarge.combined.csv"), row.names = FALSE)

FBR_Asheville.Dailydischarge.combined <- 
  bind_rows(FBR_Asheville.Dailydischarge.before,
            FBR_Asheville.Dailydischarge.after)
write.csv(FBR_Asheville.Dailydischarge.combined, 
          here("Data", "Processed", "FBR_Asheville.Dailydischarge.combined.csv"), row.names = FALSE)

BeetreeCreek_Swannanoa.Dailydischarge.combined <- 
  bind_rows(BeetreeCreek_Swannanoa.Dailydischarge.before,
            BeetreeCreek_Swannanoa.Dailydischarge.after)
write.csv(BeetreeCreek_Swannanoa.Dailydischarge.combined, 
          here("Data", "Processed", "BeetreeCreek_Swannanoa.Dailydischarge.combined.csv"), row.names = FALSE)

NFSwannanoa_Walkertown.Dailydischarge.combined <-
  bind_rows(NFSwannanoa_Walkertown.Dailydischarge.before, 
            NFSwannanoa_Walkertown.Dailydischarge.after)
write.csv(NFSwannanoa_Walkertown.Dailydischarge.combined, 
          here("Data", "Processed", "NFSwannanoa_Walkertown.Dailydischarge.combined.csv"), row.names = FALSE)

Swannanoa_Biltmore.Dailydischarge.combined <-
  bind_rows(Swannanoa_Biltmore.Dailydischarge.before,
            Swannanoa_Biltmore.Dailydischarge.after)
write.csv(Swannanoa_Biltmore.Dailydischarge.combined, 
          here("Data", "Processed", "Swannanoa_Biltmore.Dailydischarge.combined.csv"), row.names = FALSE)

FBR_Fletcher.Dailydischarge.combined <- 
  bind_rows(FBR_Fletcher.Dailydischarge.before,
            FBR_Fletcher.Dailydischarge.after)
write.csv(FBR_Fletcher.Dailydischarge.combined, 
          here("Data", "Processed", "FBR_Fletcher.Dailydischarge.combined.csv"), row.names = FALSE)

FBR_Blantyre.Dailydischarge.combined <- 
  bind_rows(FBR_Blantyre.Dailydischarge.before,
            FBR_Blantyre.Dailydischarge.after)
write.csv(FBR_Blantyre.Dailydischarge.combined, 
          here("Data", "Processed", "FBR_Blantyre.Dailydischarge.combined.csv"), row.names = FALSE)

FBR_Rosman.Dailydischarge.combined <-
  bind_rows(FBR_Rosman.Dailydischarge.before,
            FBR_Rosman.Dailydischarge.after)
write.csv(FBR_Rosman.Dailydischarge.combined, 
          here("Data", "Processed", "FBR_Rosman.Dailydischarge.combined.csv"), row.names = FALSE)
```


Plots before and after combined datasets | Daily Discharge
```{r}
ggplot(FBR_Hotsprings.Dailydischarge.combined, aes(x = date, y = mean_daily_discharge_cfs)) +
  geom_line() +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Daily Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03454500, French Broad River at Hot Springs, NC",
       x = "Sept 27 - March 27",
       y = "Mean Daily Discharge (cfs)") 

ggplot(FBR_Marshall.Dailydischarge.combined, aes(x = date, y = mean_daily_discharge_cfs)) +
  geom_line() +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Daily Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03453500, French Broad River at Marshall, NC",
       x = "Sept 27 - March 27",
       y = "Mean Daily Discharge (cfs)")

ggplot(FBR_Asheville.Dailydischarge.combined, aes(x = date, y = mean_daily_discharge_cfs)) +
  geom_line() +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Daily Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03451500, French Broad River at Asheville, NC",
       x = "Sept 27 - March 27",
       y = "Mean Daily Discharge (cfs)")

ggplot(BeetreeCreek_Swannanoa.Dailydischarge.combined, aes(x = date, y = mean_daily_discharge_cfs)) +
  geom_line() +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Daily Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03450000, Bee Tree Creek near Swannanoa, NC",
       x = "Sept 27 - March 27",
       y = "Mean Daily Discharge (cfs)")

ggplot(NFSwannanoa_Walkertown.Dailydischarge.combined, aes(x = date, y = mean_daily_discharge_cfs)) +
  geom_line() +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Daily Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #0344894205, North Fork Swannanoa River near Walkertown, NC",
       x = "Sept 27 - March 27",
       y = "Mean Daily Discharge (cfs)")

ggplot(Swannanoa_Biltmore.Dailydischarge.combined, aes(x = date, y = mean_daily_discharge_cfs)) +
  geom_line() +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Daily Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03451000, Swannanoa River at Biltmore, NC",
       x = "Sept 27 - March 27",
       y = "Mean Daily Discharge (cfs)")

ggplot(FBR_Fletcher.Dailydischarge.combined, aes(x = date, y = mean_daily_discharge_cfs)) +
  geom_line() +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Daily Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03447687, French Broad River near Fletcher, NC",
       x = "Sept 27 - March 27",
       y = "Mean Daily Discharge (cfs)")

ggplot(FBR_Blantyre.Dailydischarge.combined, aes(x = date, y = mean_daily_discharge_cfs)) +
  geom_line() +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Daily Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03443000, French Broad River at Blantyre, NC",
       x = "Sept 27 - March 27",
       y = "Mean Daily Discharge (cfs)")

ggplot(FBR_Rosman.Dailydischarge.combined, aes(x = date, y = mean_daily_discharge_cfs)) +
  geom_line() +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Daily Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03439000, French Broad River at Rosman, NC",
       x = "Sept 27 - March 27",
       y = "Mean Daily Discharge (cfs)")
```

Create before and after combined datasets | Monthly Discharge
```{r}
FBR_Hotsprings.Monthlydischarge.combined <- 
  bind_rows(FBR_HotSprings.Monthlydischarge.before, 
            FBR_HotSprings.Monthlydischarge.after)
write.csv(FBR_Hotsprings.Monthlydischarge.combined, 
          here("Data", "Processed", "FBR_Hotsprings.Monthlydischarge.combined.csv"), row.names = FALSE)

FBR_Marshall.Monthlydischarge.combined <- 
  bind_rows(FBR_Marshall.Monthlydischarge.before,
            FBR_Marshall.Monthlydischarge.after)
write.csv(FBR_Marshall.Monthlydischarge.combined, 
          here("Data", "Processed", "FBR_Marshall.Monthlydischarge.combined.csv"), row.names = FALSE)

FBR_Asheville.Monthlydischarge.combined <- 
  bind_rows(FBR_Asheville.Monthlydischarge.before,
            FBR_Asheville.Monthlydischarge.after)
write.csv(FBR_Asheville.Monthlydischarge.combined, 
          here("Data", "Processed", "FBR_Asheville.Monthlydischarge.combined.csv"), row.names = FALSE)

BeetreeCreek_Swannanoa.Monthlydischarge.combined <- 
  bind_rows(BeetreeCreek_Swannanoa.Monthlydischarge.before,
            BeetreeCreek_Swannanoa.Monthlydischarge.after)
write.csv(BeetreeCreek_Swannanoa.Monthlydischarge.combined, 
          here("Data", "Processed", "BeetreeCreek_Swannanoa.Monthlydischarge.combined.csv"), row.names = FALSE)

NFSwannanoa_Walkertown.Monthlydischarge.combined <-
  bind_rows(NFSwannanoa_Walkertown.Monthlydischarge.before, 
            NFSwannanoa_Walkertown.Monthlydischarge.after)
write.csv(NFSwannanoa_Walkertown.Monthlydischarge.combined, 
          here("Data", "Processed", "NFSwannanoa_Walkertown.Monthlydischarge.combined.csv"), row.names = FALSE)

Swannanoa_Biltmore.Monthlydischarge.combined <-
  bind_rows(Swannanoa_Biltmore.Monthlydischarge.before,
            Swannanoa_Biltmore.Monthlydischarge.after)
write.csv(Swannanoa_Biltmore.Monthlydischarge.combined, 
          here("Data", "Processed", "Swannanoa_Biltmore.Monthlydischarge.combined.csv"), row.names = FALSE)

FBR_Fletcher.Monthlydischarge.combined <- 
  bind_rows(FBR_Fletcher.Monthlydischarge.before,
            FBR_Fletcher.Monthlydischarge.after)
write.csv(FBR_Fletcher.Monthlydischarge.combined, 
          here("Data", "Processed", "FBR_Fletcher.Monthlydischarge.combined.csv"), row.names = FALSE)

FBR_Blantyre.Monthlydischarge.combined <- 
  bind_rows(FBR_Blantyre.Monthlydischarge.before,
            FBR_Blantyre.Monthlydischarge.after)
write.csv(FBR_Blantyre.Monthlydischarge.combined, 
          here("Data", "Processed", "FBR_Blantyre.Monthlydischarge.combined.csv"), row.names = FALSE)

FBR_Rosman.Monthlydischarge.combined <-
  bind_rows(FBR_Rosman.Monthlydischarge.before,
            FBR_Rosman.Monthlydischarge.after)
write.csv(FBR_Rosman.Monthlydischarge.combined, 
          here("Data", "Processed", "FBR_Rosman.Monthlydischarge.combined.csv"), row.names = FALSE)
```

Plots before and after combined datasets | Daily Discharge
```{r}
month_order <- c(9:12, 1:3)
month_order_labels <- month.abb[month_order]

ggplot(FBR_Hotsprings.Monthlydischarge.combined, 
       aes(x = factor(month, levels = month_order, 
                      labels = month_order_labels), y = mean_monthly_discharge_cfs)) +
  geom_line(group = 1) +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Monthly Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03454500, French Broad River at Hot Springs, NC",
       x = "Sept 27 - March 27",
       y = "Mean Monthly Discharge (cfs)")

ggplot(FBR_Marshall.Monthlydischarge.combined, 
       aes(x = factor(month, levels = month_order,
                      labels = month_order_labels), 
           y = mean_monthly_discharge_cfs)) +
  geom_line(group = 1) +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Monthly Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03453500, French Broad River at Marshall, NC",
       x = "Sept 27 - March 27",
       y = "Mean Monthly Discharge (cfs)")

ggplot(FBR_Asheville.Monthlydischarge.combined, 
       aes(x = factor(month, levels = month_order,
                      labels = month_order_labels), 
           y = mean_monthly_discharge_cfs)) +
  geom_line(group = 1) +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Monthly Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03451500, French Broad River at Asheville, NC",
       x = "Sept 27 - March 27",
       y = "Mean Monthly Discharge (cfs)")

ggplot(BeetreeCreek_Swannanoa.Monthlydischarge.combined, 
       aes(x = factor(month, levels = month_order,
                      labels = month_order_labels), 
           y = mean_monthly_discharge_cfs)) +
  geom_line(group = 1) +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Monthly Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03450000, Bee Tree Creek near Swannanoa, NC",
       x = "Sept 27 - March 27",
       y = "Mean Monthly Discharge (cfs)")

ggplot(NFSwannanoa_Walkertown.Monthlydischarge.combined, 
       aes(x = factor(month, levels = month_order,
                      labels = month_order_labels),
           y = mean_monthly_discharge_cfs)) +
  geom_line(group = 1) +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Monthly Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #0344894205, North Fork Swannanoa River near Walkertown, NC",
       x = "Sept 27 - March 27",
       y = "Mean Monthly Discharge (cfs)")

ggplot(Swannanoa_Biltmore.Monthlydischarge.combined, 
       aes(x = factor(month, levels = month_order,
                      labels = month_order_labels),
           y = mean_monthly_discharge_cfs)) +
  geom_line(group = 1) +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Monthly Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03451000, Swannanoa River at Biltmore, NC",
       x = "Sept 27 - March 27",
       y = "Mean Monthly Discharge (cfs)")

ggplot(FBR_Fletcher.Monthlydischarge.combined, 
       aes(x = factor(month, levels = month_order,
                      labels = month_order_labels), 
           y = mean_monthly_discharge_cfs)) +
  geom_line(group = 1) +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Monthly Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03447687, French Broad River near Fletcher, NC",
       x = "Sept 27 - March 27",
       y = "Mean Monthly Discharge (cfs)")

ggplot(FBR_Blantyre.Monthlydischarge.combined, 
       aes(x = factor(month, levels = month_order,
                      labels = month_order_labels), 
           y = mean_monthly_discharge_cfs)) +
  geom_line(group = 1) +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Monthly Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03443000, French Broad River at Blantyre, NC",
       x = "Sept 27 - March 27",
       y = "Mean Monthly Discharge (cfs)")

ggplot(FBR_Rosman.Monthlydischarge.combined, 
       aes(x = factor(month, levels = month_order,
                      labels = month_order_labels), 
           y = mean_monthly_discharge_cfs)) +
  geom_line(group = 1) +
  geom_smooth(method = "lm") +
  facet_wrap(~time_period, scales = "free_x", ncol = 2) +
  labs(title = "Mean Monthly Discharge (cfs) before and after Hurricane Helene",
       subtitle = "USGS Gage #03439000, French Broad River at Rosman, NC",
       x = "Sept 27 - March 27",
       y = "Mean Monthly Discharge (cfs)")
```



